#include <stdio.h>
#include <stdlib.h>
#include "common.h"
#include "gpio.h"
#include "i2c_func.h"

struct mpu6050_reg_map {
	int offset;
	char name[128];
};

const struct mpu6050_reg_map gyro_maps[45] = {
{25, "SAMPLE R ATE DIVIDER"},
{26, "CONFIGURATION"},
{27, "GYROSCOPE CONFIGURATION"},
{28, "ACCELEROMETER CONFIGURATION"},
{29, "FREE FALL ACCELERATION THRESHOLD"},
{30, "FREE FALL DURATION"},
{31, "MOTION DETECTION THRESHOLD"},
{32, "MOTION DETECTION DURATION"},
{33, "ZERO MOTION DETECTION THRESHOLD"},
{34, "ZERO MOTION DETECTION DURATION"},
{35, "FIFO ENABLE"},
{36, "I2C MASTER CONTROL"},
{54, "I2C MASTER STATUS"},
{55, "INT PIN / BYPASS ENABLE CONFIGURATION"},
{56, "INTERRUPT ENABLE"},
{58, "INTERRUPT STATUS"},
{59, "ACCELEROMETER MEASUREMENTS"},
{60, "ACCELEROMETER MEASUREMENTS"},
{61, "ACCELEROMETER MEASUREMENTS"},
{62, "ACCELEROMETER MEASUREMENTS"},
{63, "ACCELEROMETER MEASUREMENTS"},
{64, "ACCELEROMETER MEASUREMENTS"},
{65, "TEMPERATURE MEASUREMENT"},
{66, "TEMPERATURE MEASUREMENT"},
{67, "GYROSCOPE MEASUREMENTS"},
{68, "GYROSCOPE MEASUREMENTS"},
{69, "GYROSCOPE MEASUREMENTS"},
{70, "GYROSCOPE MEASUREMENTS"},
{71, "GYROSCOPE MEASUREMENTS"},
{72, "GYROSCOPE MEASUREMENTS"},
{97, "MOTION DETECTION STATUS"},
{99, "I2C SLAVE 0 DATA OUT"},
{100, "I2C SLAVE 1 DATA OUT"},
{101, "I2C SLAVE 2 DATA OUT"},
{102, "I2C SLAVE 3 DATA OUT"},
{103, "I2C MASTER DELAY CONTROL"},
{104, "SIGNAL PATH RESET"},
{105, "MOTION DETECTION CONTROL"},
{106, "USER CONTROL"},
{107, "POWER MANAGEMENT 1"},
{108, "POWER MANAGEMENT 2"},
{114, "FIFO COUNT REGISTERS"},
{115, "FIFO COUNT REGISTERS"},
{116, "FIFO READ WRITE"},
{117, "WHO AM I"}};

int main(int argc, char *argv[])
{
	int i;

    int fd_mpu6050 = i2c_open(1, 0x68);
	if(fd_mpu6050 < 0)
	{
		printf("open i2c device failed\n");
		return -1;
	}
	for(i=0;i<45;i++)
	{
		printf("%s: %d\n", gyro_maps[i].name, i2c_smbus_read_byte_data(fd_mpu6050, gyro_maps[i].offset));

		delay_ms(10);
	}
	
	i2c_close(fd_mpu6050);
	return 0;
}
